!function(e){"use strict";var t=function(){function e(e,t){for(var a in t){var n=t[a];n.configurable=!0,n.value&&(n.writable=!0)}Object.defineProperties(e,t)}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(e){var o=e.fn.wysiwyg,l={toolbar:[["mode"],["operations",["undo","rendo","cut","copy","paste"]],["styles"],["fonts",["select","size"]],["text",["bold","italic","underline","strike","subscript","superscript","font-color","bg-color"]],["align",["left","center","right","justify"]],["lists",["unordered","ordered","indent","outdent"]],["components",["table"]],["intervals",["line-height","letter-spacing"]],["insert",["emoji","link","image","video","symbol"]],["special",["print","unformat","visual","clean"]]],fontSizes:["8px","9px","10px","11px","12px","14px","15px","16px","18px","20px","24px","30px","32px","36px","48px"],fontSizeDefault:"12px",fontFamilies:["Open Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],fontFamilyDefault:"Open Sans",emojiDefault:["😀","😬","😁","😂","😃","😄","😅","😆","😇","😉","😊","🙂","🙃","😋","😌","😍","😘","😗","😙","😚","😜","😝","😛","🤑","🤓","😎","🤗","😏","😶","😐","😑","😒","🙄","🤔","😳","😞","😟","😠","😡","😔","😕","🙁","😣","😖","😫","😩","😤","😮","😱","😨","😰","😯","😦","😧","😢","😥","😪","😓","😭","😵","😲","🤐","😷","🤒","🤕","😴","💤"],symbolsDefault:["&lt;","&gt;","&laquo;","&raquo;","&lsaquo;","&rsaquo;","&quot;","&prime;","&Prime;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&#10076;","&#10075;","&amp;","&apos;","&sect;","&copy;","&not;","&reg;","&macr;","&deg;","&plusmn;","&sup1;","&sup2;","&sup3;","&frac14;","&frac12;","&frac34;","&acute;","&micro;","&para;","&middot;","&iquest;","&fnof;","&trade;","&bull;","&hellip;","&oline;","&ndash;","&mdash;","&permil;","&#125;","&#123;","&#61;","&ne;","&cong;","&asymp;","&le;","&ge;","&ang;","&perp;","&radic;","&sum;","&int;","&#8251;","&divide;","&infin;","&#64;","&#91;","&#93;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&crarr;","&lArr;","&uArr;","&rArr;","&dArr;","&hArr;","&#10144;","&#10148;","&#10149;","&#10150;","&#10163;","&#8634;","&#8635;","&#8679;","&#8617;","&#11015;","&#11014;","&spades;","&clubs;","&hearts;","&diams;","&#9825;","&#9826;","&#9828;","&#9831;","&#8372;","&euro;","&dollar;","&cent;","&pound;","&#8381;","&yen;","&#8377;","&#22291;","&#8376;"],colorPalette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(153, 153, 153)","rgb(183, 183, 183)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(239, 239, 239)","rgb(243, 243, 243)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(133, 32, 12)","rgb(153, 0, 0)","rgb(180, 95, 6)","rgb(191, 144, 0)","rgb(56, 118, 29)","rgb(19, 79, 92)","rgb(17, 85, 204)","rgb(11, 83, 148)","rgb(53, 28, 117)","rgb(116, 27, 71)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]],mode:"editor",language:"en-us",translations:{},highlight:!0,debug:!1};const r={"Header H1":{action:"formatblock",value:"h1",wrap:"<h1 />"},"Header H2":{action:"formatblock",value:"h2",wrap:"<h2 />"},"Header H3":{action:"formatblock",value:"h3",wrap:"<h3 />"},"Header H4":{action:"formatblock",value:"h4",wrap:"<h4 />"},"Header H5":{action:"formatblock",value:"h5",wrap:"<h5 />"},"Header H6":{action:"formatblock",value:"h6",wrap:"<h6 />"},Paragraph:{action:"formatblock",value:"p",wrap:"<p />"},Blockquote:{action:"formatblock",value:"blockquote",wrap:"<blockquote />"},Preformatted:{action:"formatblock",value:"pre",wrap:"<pre />"},"Div block":{action:"formatblock",value:"div",wrap:"<div />"}},i={youtube:"YouTube",vimeo:"Vimeo",dailymotion:"Dailymotion",source:"Source media"},s={https:"https://",http:"http://",mailto:"mailto://",ftp:"ftp://",feed:"feed://",news:"news://",tel:"tel:",skype:"skype:",telegram:"tg://",whatsapp:"whatsapp:",viber:"viber:",other:"other"},d={blank:"New tab",top:"Main tab",self:"Current tab",parent:"Parent tab"},c={nofollow:"Do not follow (for robots)",noreferrer:"Do not pass HTTP-referrer"};var u=function(){function o(t,n){var i=this;a(i,o),i._config=e.extend({},l,n),i._config.debug&&console.log("Init WYSIWYG editor..."),i._editorId="wysiwyg-"+(String.fromCharCode(Math.floor(11*Math.random()))+Math.floor(1e6*Math.random())).trim(),i._$element=t instanceof jQuery?t:e(t),i._inputId=i._$element.attr("id"),i._$editor=e('<div id="'+i._editorId+'" aria-describedby="#'+i._inputId+'" class="wysiwyg-editor" />'),i._$element.wrap(i._$editor),i._$content=e('<div class="editor-content" contenteditable="true" />'),i._$content.html(i._$element.val()),i._$element.before(i._$content),i._source=i._$element.val(),i._selection=document.getSelection(),i._popoverIsVisible=!1,i._$lastFocus=null,i._$toolbar=e('<div class="wysiwyg-toolbar btn-toolbar" />'),i._$content.before(i._$toolbar),i._$statusbar=e('<div class="editor-statusbar" />'),i._$statusbar.stat=e('<span class="editor-statusbar-stat" />'),i._$statusbar.path=e('<span class="editor-statusbar-path" />'),i._$statusbar.append(i._$statusbar.stat),i._$statusbar.append(i._$statusbar.path),i._$content.after(i._$statusbar),i._$element.addClass("hide"),"object"==typeof i._config.toolbar&&e.each(i._config.toolbar,function(t,a){var n=e('<div id="toolbarGroup-'+a[0]+'" class="btn-group" role="group" />');if("mode"===a[0]){var o=i._buildTollbarButton("mode","editor","fa fa-eye",null,"Editor"),l=i._buildTollbarButton("mode","source","fa fa-code",null,"Source");"editor"==i._config.mode?o.addClass("active"):l.addClass("active"),n.append(o),n.append(l)}else if("operations"===a[0])n.append(i._buildTollbarButton("operations","undo","fa fa-reply",null,"Undo")),n.append(i._buildTollbarButton("operations","rendo","fa fa-share",null,"Rendo")),n.append(i._buildTollbarButton("operations","cut","fa fa-cut",null,"Cut")),n.append(i._buildTollbarButton("operations","copy","fa fa-copy",null,"Copy")),n.append(i._buildTollbarButton("operations","paste","fa fa-clipboard",null,"Paste"));else if("styles"===a[0])n.append(i._buildTollbarDropdown("select-style",r,"Paragraph","Text style"));else if("fonts"===a[0]){if(-1!==a[1].indexOf("select",0)){var s={};e.each(i._config.fontFamilies,function(e,t){s[t]={action:"fontname",value:t,style:"font-family: "+t+";"}}),n.append(i._buildTollbarDropdown("font-select",s,i._config.fontFamilyDefault,"Font family"))}if(-1!==a[1].indexOf("size",0)){var d={};e.each(i._config.fontSizes,function(e,t){d[t]={action:"fontsize",value:t}}),n.append(i._buildTollbarDropdown("font-size",d,i._config.fontSizeDefault,"Font size"))}}else"text"===a[0]?(-1!==a[1].indexOf("bold",0)&&n.append(i._buildTollbarButton("text","bold","fa fa-bold",null,"Bold")),-1!==a[1].indexOf("italic",0)&&n.append(i._buildTollbarButton("text","italic","fa fa-italic",null,"Italic")),-1!==a[1].indexOf("underline",0)&&n.append(i._buildTollbarButton("text","underline","fa fa-underline",null,"Underline")),-1!==a[1].indexOf("strike",0)&&n.append(i._buildTollbarButton("text","strike","fa fa-strikethrough",null,"Striked text")),-1!==a[1].indexOf("subscript",0)&&n.append(i._buildTollbarButton("text","subscript","fa fa-subscript",null,"Subscript")),-1!==a[1].indexOf("superscript",0)&&n.append(i._buildTollbarButton("text","superscript","fa fa-superscript",null,"Superscript")),-1!==a[1].indexOf("bg-color",0)&&n.append(i._buildTollbarButton("text","font-color","fa fa-font",null,"Font color",i._buildColorPalette(i._config.colorPalette,"font-color",null))),-1!==a[1].indexOf("bg-color",0)&&n.append(i._buildTollbarButton("text","bg-color","fa fa-paint-brush",null,"Background color",i._buildColorPalette(i._config.colorPalette,"bg-color",!0)))):"align"===a[0]?(-1!==a[1].indexOf("left",0)&&n.append(i._buildTollbarButton("align","left","fa fa-align-left",null,"Align left",null)),-1!==a[1].indexOf("center",0)&&n.append(i._buildTollbarButton("align","center","fa fa-align-center",null,"Align center",null)),-1!==a[1].indexOf("right",0)&&n.append(i._buildTollbarButton("align","right","fa fa-align-right",null,"Align right",null)),-1!==a[1].indexOf("justify",0)&&n.append(i._buildTollbarButton("align","justify","fa fa-align-justify",null,"Justify content",null))):"lists"===a[0]?(-1!==a[1].indexOf("unordered",0)&&n.append(i._buildTollbarButton("lists","unordered","fa fa-list-ul",null,"Unordered list")),-1!==a[1].indexOf("ordered",0)&&n.append(i._buildTollbarButton("lists","ordered","fa fa-list-ol",null,"Ordered list")),-1!==a[1].indexOf("indent",0)&&n.append(i._buildTollbarButton("lists","indent","fa fa-indent",null,"Indent")),-1!==a[1].indexOf("outdent",0)&&n.append(i._buildTollbarButton("lists","outdent","fa fa-outdent",null,"Outdent"))):"components"===a[0]?(-1!==a[1].indexOf("table",0)&&n.append(i._buildTollbarButton("components","table","fa fa-table",null,"Insert table",i._buildTableGrid())),-1!==a[1].indexOf("chart",0)&&n.append(i._buildTollbarButton("components","chart","fa fa-pie-chart",null,"Add chart"))):"intervals"===a[0]?(-1!==a[1].indexOf("line-height",0)&&n.append(i._buildTollbarButton("interval","line-height","fa fa-text-height",null,"Lines interval",i._buildLineHeightList())),-1!==a[1].indexOf("letter-spacing",0)&&n.append(i._buildTollbarButton("interval","letter-spacing","fa fa-text-width",null,"Letter spacing",i._buildLetterSpacingList()))):"insert"===a[0]?(-1!==a[1].indexOf("emoji",0)&&n.append(i._buildTollbarButton("insert","emoji","fa fa-smile fa-smile-o",null,"Add emoji",i._buildEmojiList())),-1!==a[1].indexOf("link",0)&&n.append(i._buildTollbarButton("insert","link","fa fa-link",null,"Add URL",i._buildUrlForm("link"))),-1!==a[1].indexOf("image",0)&&n.append(i._buildTollbarButton("insert","image","fa fa-image",null,"Add image",i._buildUrlForm("image"))),-1!==a[1].indexOf("video",0)&&n.append(i._buildTollbarButton("insert","video","fa fa-video-camera fa-video",null,"Add video",i._buildUrlForm("video"))),-1!==a[1].indexOf("symbol",0)&&n.append(i._buildTollbarButton("insert","symbol","fa fa-hashtag",null,"Add symbol",i._buildSymbolsList())),-1!==a[1].indexOf("bookmark",0)&&n.append(i._buildTollbarButton("insert","bookmark","fa fa-bookmark",null,"Add bookmark"))):"special"===a[0]?(-1!==a[1].indexOf("print",0)&&n.append(i._buildTollbarButton("special","print","fa fa-print",null,"Print")),-1!==a[1].indexOf("clean",0)&&n.append(i._buildTollbarButton("special","clean","fa fa-eraser",null,"Erase style")),-1!==a[1].indexOf("visual",0)&&n.append(i._buildTollbarButton("special","visual","fa fa-solar-panel",null,"Visual blocks")),-1!==a[1].indexOf("unformat",0)&&n.append(i._buildTollbarButton("special","unformat","fa fa-trash-o fa-trash-alt",null,"Clear HTML"))):"fullscreen"===a[0]&&(n.addClass("pull-right"),n.append(i._buildTollbarButton("fullscreen",!0,"fa fa-arrows-alt",null,"Fullscreen mode")));i._$toolbar.append(n)}),i._$toolbar.length&&i._$toolbar.on("click","[data-action]",function(t){var a=e(t.currentTarget),n=a.data("action"),o=(i._selection,a.data("value")),l=a.data();if(void 0!==n&&void 0!==o)switch(i._config.debug&&console.log("Switch action: `"+n+"` with value: `"+o+"`"),n){case"mode":switch(o){case"editor":i._config.mode!==o&&(i._config.mode=o,i._$content.html(i._source),i._$toolbar.find('[data-action="mode"]').removeClass("active"),i._$toolbar.find('[data-action="mode"][data-value="editor"]').addClass("active"),i._$content.addClass("editor-mode").removeClass("source-mode"),i._$content.focus()),i._$toolbar.find(".btn-group").removeClass("hide");break;case"source":if(i._$toolbar.find(".btn-group").not("#toolbarGroup-"+n).addClass("hide"),i._config.mode!==o){i._config.mode=o,i._source=i._$content.html();var r=e("<pre />");r.text(i._source),i._$content.html(i._trimSource(r.html())),i._config.highlight&&(hljs.initHighlighting.called=!1,hljs.configure({useBR:!0,languages:["html","javascript","css"]}),hljs.highlightBlock(i._$content.get(0))),i._$toolbar.find('[data-action="mode"]').removeClass("active"),i._$toolbar.find('[data-action="mode"][data-value="source"]').addClass("active"),i._$content.removeClass("editor-mode").addClass("source-mode"),i._$content.focus()}}break;case"formatblock":i._formatDoc("formatblock",o);break;case"fontname":i._formatDoc("fontname",o);break;case"fontsize":i._selection.anchorNode.parentElement.removeAttribute("size"),i._selection.anchorNode.parentElement.style.fontSize=o;break;case"style":var s=i._selection.anchorNode.parentElement.style.cssText;s?s+=o:s=o,i._selection.anchorNode.parentElement.removeAttribute("style"),i._selection.anchorNode.parentElement.style=s;break;case"fullscreen":i._config.debug&&console.log("Fire action: "+n+" with value: "+o+" is not supported.");break;case"operations":switch(o){case"undo":i._formatDoc("undo");break;case"rendo":i._formatDoc("rendo");break;case"cut":i._formatDoc("cut");break;case"copy":i._formatDoc("copy");break;case"paste":i._formatDoc("paste")}break;case"text":switch(o){case"bold":i._formatDoc("bold");break;case"italic":i._formatDoc("italic");break;case"underline":i._formatDoc("underline");break;case"strike":i._formatDoc("strikeThrough");break;case"subscript":i._formatDoc("subscript");break;case"superscript":i._formatDoc("superscript")}break;case"font-color":"unset"==o?(i._selection.anchorNode&&(i._selection.anchorNode.parentElement.style.backgroundColor=""),i._selection.anchorNode.parentElement.style.length&&i._selection.anchorNode.parentElement.removeAttribute("style")):(i._$toolbar.find('[data-action="text"][data-value="font-color"] > span').css("border-bottom-color",o),i._formatDoc("foreColor",o));break;case"bg-color":"unset"==o?(i._selection.anchorNode&&(i._selection.anchorNode.parentElement.style.backgroundColor=""),i._selection.anchorNode.parentElement.style.length&&i._selection.anchorNode.parentElement.removeAttribute("style")):(i._$toolbar.find('[data-action="text"][data-value="bg-color"] > span').css("border-bottom-color",o),i._formatDoc("hiliteColor",o));break;case"align":switch(o){case"left":i._formatDoc("justifyLeft");break;case"center":i._formatDoc("justifyCenter");break;case"right":i._formatDoc("justifyRight");break;case"justify":i._formatDoc("justifyFull")}break;case"lists":switch(o){case"unordered":i._formatDoc("insertUnorderedList");break;case"ordered":i._formatDoc("insertOrderedList");break;case"indent":i._formatDoc("indent");break;case"outdent":i._formatDoc("outdent")}break;case"insert-table":if(i._selection.anchorNode){var d=o.split("|",2),c=e(i._selection.anchorNode.parentElement),u=i._generateTable(parseFloat(d[0]),parseFloat(d[2]));c.after(u)}break;case"components":switch(o){case"chart":i._config.debug&&console.log("Fire action: "+n+" with value: "+o+" is not supported.")}break;case"line-height":if(i._selection.anchorNode){var p=100*parseFloat(o)+"%";0==parseFloat(o)?i._selection.anchorNode.parentElement.style.lineHeight="inherit":i._selection.anchorNode.parentElement.style.lineHeight=p}break;case"letter-spacing":if(i._selection.anchorNode){var f=parseFloat(o)+"px";0==parseFloat(o)?i._selection.anchorNode.parentElement.style.letterSpacing="inherit":i._selection.anchorNode.parentElement.style.letterSpacing=f}break;case"add-url":var b=i._selection.toString();if(i._selection&&b){var g=o;console.log(l),l.scheme&&("https"==l.scheme?g="https://"+g:"http"==l.scheme?g="http://"+g:"mailto"==l.scheme?g="mailto://"+g:"ftp"==l.scheme?g="ftp://"+g:"feed"==l.scheme?g="feed://"+g:"news"==l.scheme?g="news://"+g:"tel"==l.scheme?g="tel:"+g:"skype"==l.scheme?g="skype:"+g:"tg"==l.scheme?g="tg://"+g:"whatsapp"==l.scheme?g="whatsapp:"+g:"viber"==l.scheme&&(g="viber:"+g));var h="";l.title&&(h=' title="'+l.title+'"');var v="";l.class&&(v=' class="'+l.class+'"');var m="";l.target&&("blank"==l.target?m=' target="_blank"':"top"==l.target?m=' target="_top"':"self"==l.target?m=' target="_self"':"parent"==l.target&&(m=' target="_parent"'));var _="";l.relation&&("nofollow"==l.relation?_=' rel="nofollow"':"noreferrer"==l.relation&&(_=' rel="noreferrer"'));var y=e('<a href="'+g+'"'+h+v+m+_+" />");y.text(b),(C=i._selection.getRangeAt(0)).deleteContents(),C.insertNode(y.get(0))}break;case"add-video":if(i._selection&&o){g=o;if(l.service)if("youtube"==l.service){var x=null,w=/^.*(youtube\/|youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;null!==(k=g.match(w))&&11==k[2].length&&(x=k[2]),x&&(g="https://www.youtube.com/embed/"+x)}else if("vimeo"==l.service){x=null,w=/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?/i;null!==(k=g.match(w))&&9==k[1].length&&(x=k[1]),x&&(g="https://player.vimeo.com/video/"+k[1])}else if("dailymotion"==l.service){var k;x=null,w=/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/;null!==(k=g.match(w))&&(void 0!==k[4]&&(x=k[4]),x=k[2]),x&&(g="https://www.dailymotion.com/embed/video/"+x)}var $=e('<div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+g+'"></iframe></div>');(C=i._selection.getRangeAt(0)).deleteContents(),C.insertNode($.get(0))}break;case"add-image":if(i._selection&&o){var C,T=e('<img src="'+o+'" />');(C=i._selection.getRangeAt(0)).deleteContents(),C.insertNode(T.get(0))}break;case"insert-html":i._formatDoc("insertHTML",o);break;case"special":switch(o){case"print":i._printDoc();break;case"clean":i._formatDoc("removeFormat");break;case"visual":i._$content.hasClass("visual")?(i._$toolbar.find('[data-action="special"][data-value="visual"]').removeClass("active"),i._$content.removeClass("visual"),i._$content.focus()):(i._$toolbar.find('[data-action="special"][data-value="visual"]').addClass("active"),i._$content.addClass("visual"),i._$content.focus());break;case"unformat":i._formatDoc("selectAll"),i._formatDoc("removeFormat");var S=i._$content.html();S=(S=(S=i._stripTags(S)).replace(/(\r\n|\n|\r)/g,"\x3c!-- br --\x3e")).replace(/<!-- br -->/g,"<br/>"),i._$content.html(S)}break;default:i._config.debug&&console.warn("Unrecognized action: "+n+" with value: "+o)}}),i._$content.on("mouseup click focus",function(t){const a=e(this);if(i._popoverIsVisible&&i._hideAllPopovers(),"text"!==t.target.type&&(i._selection=document.getSelection()),i._selection.getRangeAt&&i._selection.rangeCount)if(i._selection.parentNode){var n=e(i._selection.parentNode);i._updateState(n)}else if(i._selection.parentElement){n=e(i._selection.parentElement);i._updateState(n)}i._config.debug&&console.log("Current selection: ",i._selection);n=e(t.target);i._updateState(n),a.trigger("change")}),i._$content.on("keydown",function(t){const a=e(this);if(i._popoverIsVisible&&i._hideAllPopovers(),"text"!==t.target.type&&(i._selection=document.getSelection()),i._selection.getRangeAt&&i._selection.rangeCount)if(i._selection.parentNode){var n=e(i._selection.parentNode);i._updateState(n)}else if(i._selection.parentElement){n=e(i._selection.parentElement);i._updateState(n)}n=e(t.target);i._updateState(n),a.trigger("change"),i._config.debug&&console.log("Keydown fired: "+t.keyCode)}),i._$content.on("change",function(t){const a=e(this);setTimeout(function(){"editor"==i._config.mode?i._source=a.html():i._source=a.text(),e(i._$element).is("textarea")?i._$element.html(i._source):i._$element.val(i._source),i._config.debug&&console.log("Content change...")},200)}),i._$content.on("blur",function(){const t=e(this);i._$lastFocus=this,i._selection=document.getSelection(),t.trigger("change"),i._config.debug&&console.log("Content lost focus: ",i._selection)}),i._$content.focus()}return t(o,{element:{value:function(){return this._$element}},_replaceAll:{value:function(e,t,a){return a.split(e).join(t)}},_stripTags:{value:function(e,t){var a,n=[];t&&(n=t.match(/([a-zA-Z]+)/gi)),"string"!=typeof e&&(e=e.toString());var o=e.match(/(<\/?[\S][^>]*>)/gi);for(a in o)if(!isNaN(a)){var l=o[a].toString(),r=!1;for(a in n){var i=n[a],s=l.toLowerCase().indexOf("<"+i+">");if(0!=s&&(s=l.toLowerCase().indexOf("<"+i+" ")),0!=s&&(s=l.toLowerCase().indexOf("</"+i)),0==s){r=!0;break}}r||(e=this._replaceAll(l,"",e))}return e}},_trimSource:{value:function(e){return e=(e=(e=e.replace(/\s{4,}/g,"")).replace(/\t/g," ")).toString().trim().replace(/(\r\n|\n|\r)/g,"")}},_getPath:{value:function(t,a,n){for(var o,l=[];t.length&&!t[0].isEqualNode(a[0]);){var r=t[0],i=r.localName,s=t.parentsUntil(a);if(!i)break;if(i=i.toLowerCase(),n&&s.children(i).length>1){var d=s.children().index(r)+1;d>1&&(i+=":nth-child("+d+")")}l.push(i);var c=e(r).attr("id");c&&(i+="#"+c);var u=e(r).attr("class");u&&(i+="."+u.replace(/\./g,".")),o=i+(o?" > "+o:""),t=s}return{path:o,tags:l}}},_getTextStat:{value:function(e){var t;return t=e&&e.contentEditable?e.innerText.replace(/\r\n/g,"\n"):e.value.replace(/\r\n/g,"\n"),{words:this._stripTags(t).split(" ").length,length:t.length,chars:this._trimSource(t.replace(/\s/g,"")).length}}},_getTextPosition:{value:function(e){var t,a,n,o,l,r=0,i=0,s=0,d=e&&e.contentEditable;return"selectionStart"in e&&document.activeElement==e?(i=e.selectionStart,s=e.selectionEnd,r=(t=e.value.replace(/\r\n/g,"\n")).substr(0,e.selectionStart).split("\n").length):d?(i=window.getSelection().getRangeAt(0).startOffset,s=window.getSelection().getRangeAt(0).endOffset,0==(r=(t=e.innerText.replace(/\r\n/g,"\n")).substr(0,e.selectionStart).split("\n").length-1)&&(r=1)):(a=this._selection.createRange())&&a.parentElement()==e&&(o=e.value.length,t=e.value.replace(/\r\n/g,"\n"),(n=e.createTextRange()).moveToBookmark(a.getBookmark()),(l=e.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",l)>-1?i=s=o:(i=-n.moveStart("character",-o),i+=t.slice(0,i).split("\n").length-1,n.compareEndPoints("EndToEnd",l)>-1?s=o:(s=-n.moveEnd("character",-o),s+=t.slice(0,s).split("\n").length-1))),{line:r,start:i,end:s,selected:this._selection.toString().length}}},_formatDoc:{value:function(e,t){document.execCommand(e,!1,t),this._$content.focus()}},_printDoc:{value:function(){var e=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");e.document.open(),e.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+this._$content.get(0).innerHTML+"</body></html>"),e.document.close()}},_hideAllPopovers:{value:function(){this._$toolbar.find(".popover").each(function(){e(this).popover("hide")}),this._popoverIsVisible=!1}},_detectLanguage:{value:function(){return(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en").toLowerCase()}},_translate:{value:function(e){var t=this._config.language;return void 0===t&&(t=this._detectLanguage()),this._config.translations.hasOwnProperty(t)&&this._config.translations[t][e.toString()]&&(e=this._config.translations[t][e.toString()]),e.toLocaleString()}},_buildTollbarButton:{value:function(t,a,n,o,l,r){var i=this,s=(i._selection,e('<button type="button" class="btn btn-default" tabindex="-1" />'));return t&&s.attr("data-action",t),a&&s.attr("data-value",a),o&&s.attr("data-hotkey",o),l&&s.tooltip({html:!0,placement:"top",container:"body",title:i._translate(l.toString().trim())}),r?s.popover({html:!0,trigger:"manual",viewport:"body",placement:"bottom",content:function(){return"object"==typeof r?r:e(r)}}).on("shown.bs.popover",function(t){var a=e(t.target).attr("aria-describedby"),n=i._$toolbar.find("#"+a),o=i._selection,l=o.getRangeAt(0);o&&l&&n.find("input").on("blur",function(e){return"text"==e.target.type&&i._$lastFocus&&setTimeout(function(){i._$lastFocus.focus(),i._selectText(o,l)},50),!1}),n.on("click",function(t){t.preventDefault(),i._config.debug&&(console.log("Popover event target type: "+t.target.type),console.log("Popover event target tag: "+t.target.tagName)),(t.target.type||"a"==t.target.tagName.toLowerCase())&&e(t.target).get(0).hasAttribute("data-action")&&n.popover("hide")}),n.find(".table-grid").length&&n.find(".table-grid tr > td").hover(function(){e(this).addClass("selected"),e(this).prevAll().addClass("selected"),e(this).parent().prevAll().find("td:lt("+(e(this).index()+1)+")").addClass("selected")},function(){e(this).removeClass("selected"),e(this).prevAll().removeClass("selected"),e(this).parent().prevAll().find("td:lt("+(e(this).index()+1)+")").removeClass("selected")})}).on("click",function(e){i._config.debug&&(console.log("Element event target type: "+e.target.type),console.log("Element event target tag: "+e.target.tagName)),e.preventDefault(),e.stopPropagation(),i._popoverIsVisible&&i._hideAllPopovers(),s.popover("show"),i._popoverIsVisible=!0}):s.on("click",function(e){e.preventDefault(),i._hideAllPopovers()}),n&&s.append('<span class="'+n+'" />'),s}},_buildTollbarDropdown:{value:function(t,a,n,o){var l=e('<div class="dropdown" />'),r=e('<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" />'),i=e('<ul class="dropdown-menu" />'),s=e("<li />"),d=e('<a href="#" tabindex="-1" />');return"object"==typeof a&&e.each(a,function(a,o){var l=d.clone(),r=s.clone();"object"==typeof o?(o.action&&l.attr("data-action",o.action),o.value&&l.attr("data-value",o.value),o.wrap?l.html(e(o.wrap).text(a)):l.text(a),o.style&&l.attr("style",o.style.toString()),a==n&&r.addClass("active"),r.append(l),i.append(r)):(l.text(o),l.attr("data-action",t),l.attr("data-value",o),o==n&&r.addClass("active"),r.append(l),i.append(r)),l.on("click",function(e){e.preventDefault()})}),n?r.text(n+" "):r.text("Dropdown "),r.append('<b class="caret" />'),o&&r.tooltip({html:!0,placement:"top",title:this._translate(o.toString().trim())}),l.append(r),l.append(i),l}},_buildColorPalette:{value:function(t,a,n){var o="";return e.each(t,function(t,n){o+='<table class="color-palette"><tr>',e.each(n,function(e,t){o+='<td><a href="#" data-action="'+a+'" data-value="'+t+'" style="background-color: '+t+'">&nbsp;</a></td>',o+=(parseInt(e)+1)%10?"":"</tr>",o+=(parseInt(e)+1)%10?"":"<tr>"}),o+="</tr></table>"}),n&&(o+='<p><a href="#" class="btn btn-sm btn-block" data-action="'+a+'" data-value="unset">Reset color</a></p>'),o}},_buildTableGrid:{value:function(){for(var e='<table class="table-grid">',t=1;t<=6;t++){e+="<tr>";for(var a=1;a<=8;a++)e+='<td><a href="#" data-action="insert-table" data-value="'+t+"|"+a+'">&nbsp;</a></td>';e+="</tr>"}return e+="</table>"}},_buildLetterSpacingList:{value:function(){return'<ul class="nav nav-pills nav-stacked">\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-5">-5</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-3">-3</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-2">-2</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="-1">-1</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="0">0</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="1">1</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="2">2</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="3">3</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="5">5</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="8">8</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="10">10</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="12">12</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="15">15</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="25">25</a></li>\n  <li role="presentation"><a href="#" data-action="letter-spacing" data-value="50">50</a></li>\n</ul>'}},_buildLineHeightList:{value:function(){return'<ul class="nav nav-pills nav-stacked">\n  <li role="presentation"><a href="#" data-action="line-height" data-value="0.5">0.5</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="1.0">1.0</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="1.15">1.15</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="1.5">1.5</a></li>\n  <li role="presentation"><a href="#" data-action="line-height" data-value="2.0">2.0</a></li>\n</ul>'}},_selectText:{value:function(e,t){e||(e=document.getSelection()),t||(t=e.getRangeAt(0)),e.removeAllRanges(),e.addRange(t)}},_buildEmojiList:{value:function(){var e=this._config.emojiDefault;if(e.length>0){for(var t=Math.round(e.length/8)+1,a='<table class="emojis-list">',n=1,o=0;n<=t;n++){a+="<tr>";for(var l=1;l<=8&&o!=e.length;l++)a+='<td><a href="#" data-action="insert-html" data-value="'+e[o].toString()+'">'+e[o]+"</a></td>",o++;a+="</tr>"}return a+="</table>"}return!1}},_buildSymbolsList:{value:function(){var e=this._config.symbolsDefault;if(e.length>0){for(var t=Math.round(e.length/10),a='<table class="symbols-list">',n=1,o=0;n<=t;n++){a+="<tr>";for(var l=1;l<=10&&o!=e.length;l++)a+='<td><a href="#" data-action="insert-html" data-value="'+e[o]+'" style="min-width:16px;text-align:center;">'+e[o]+"</a></td>",o++;a+="</tr>"}return a+="</table>"}return!1}},_buildDdropdown:{value:function(t,a,n,o,l,r){null==a&&(a="Not set"),null==n&&(n='<span class="caret"></span>'),null==o&&(n={}),null==r&&(r="data-value");var i=e('<div class="dropdown" />'),s=e('<button type="button" class="btn btn-block btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" />');s.attr("id",t),s.html(a+" "+n);var d=e('<ul class="dropdown-menu" aria-labelledby="'+t+'" />');l||d.append('<li class="active"><a href="#">'+a+"</a></li>");for(let[e,t]of Object.entries(o))"separator"==e.toString()?d.append('<li role="separator" class="divider"></li>'):l==e.toString()?d.append('<li class="active"><a href="#" '+r+'="'+e+'">'+t+"</a></li>"):d.append('<li><a href="#" '+r+'="'+e+'">'+t+"</a></li>");return d.find("li").on("click",function(t){d.find("li").removeClass("active"),e(this).addClass("active"),s.html(e(this).text()+" "+n)}),i.append(s),i.append(d),i}},_buildUrlForm:{value:function(t){this._config.debug&&console.log("Build URL form for type: "+t);var a=e('<form class="form-horizontal" />'),n=e('<div class="form-group" />'),o=e('<div class="col-xs-12 col-sm-12" />'),l=e('<div class="input-group input-group-sm" />'),r=e('<div class="dropdown" />');e('<button type="button" class="btn btn-block btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" />');if("image"==t)l.append('<span class="input-group-addon">Image:</span>');else if("video"==t){(r=this._buildDdropdown("videoServices","YouTube",null,i,"youtube","data-service")).attr("class","input-group-btn"),r.find('.btn[data-toggle="dropdown"]').toggleClass("btn-default","btn-secondary"),l.append(r)}else if("link"==t){(r=this._buildDdropdown("urlSchemes","https://",null,s,"https","data-scheme")).attr("class","input-group-btn"),r.find('.btn[data-toggle="dropdown"]').toggleClass("btn-default","btn-secondary"),l.append(r)}var u=e('<input type="text" class="form-control" placeholder="Type your URL..." />');"image"==t?u.attr("id","imageUrl"):"video"==t?u.attr("id","videoUrl"):"link"==t&&u.attr("id","urlInput"),l.append(u);var p=e('<span class="input-group-btn" />'),f=e('<button type="button" class="btn btn-block btn-primary">Add</button>');if("image"==t?f.attr("data-action","add-image"):"video"==t?f.attr("data-action","add-video"):f.attr("data-action","add-url"),f.on("click",function(t){var n=e(t.target).data("action");if(e(t.target).data("value",u.val()),"add-url"==n){var o=a.find('[aria-labelledby="urlSchemes"] li.active a[data-scheme]').first().data("scheme");e(t.target).data("scheme",o||null);var l=a.find("#urlTile").val();e(t.target).data("title",l||null);var r=a.find("#urlClass").val();e(t.target).data("class",r||null);var i=a.find('[aria-labelledby="urlLinkTarget"] li.active a[data-target]').first().data("target");e(t.target).data("target",i||null);var s=a.find('[aria-labelledby="urlLinkRel"] li.active a[data-rel]').first().data("rel");e(t.target).data("relation",s||null)}else if("add-video"==n){var d=a.find('[aria-labelledby="videoServices"] li.active a[data-service]').first().data("service");e(t.target).data("service",d||null)}console.log(f.data())}),p.append(f),l.append(p),o.append(l),n.append(o),a.append(n),"link"==t){var b="";b+='<div class="form-group form-group-sm">',b+='    <div class="form-row">',b+='        <label class="col-xs-12 col-sm-4">Tile:</label>',b+='        <div class="col-xs-12 col-sm-8">',b+='            <input type="text" class="form-control" id="urlTile" placeholder="Title of link..." />',b+="        </div>",b+="    </div>",b+="</div>",b+='<div class="form-group form-group-sm">',b+='    <div class="form-row">',b+='        <label class="col-xs-12 col-sm-4">Class:</label>',b+='        <div class="col-xs-12 col-sm-8">',b+='            <input type="text" class="form-control" id="urlClass" placeholder="CSS class name..." />',b+="        </div>",b+="    </div>",b+="</div>",a.append(b);n=e('<div class="form-group form-group-sm" />'),l=e('<div class="form-row input-group-sm" />');(g=e('<label class="col-xs-12 col-sm-4" />')).text("Target:"),l.append(g),(r=this._buildDdropdown("urlLinkTarget","Not set",null,d,null,"data-target")).addClass("col-xs-12 col-sm-8"),r.find('.btn[data-toggle="dropdown"]').addClass("btn-sm"),l.append(r),n.append(l),a.append(n);var g;n=e('<div class="form-group form-group-sm" />'),l=e('<div class="form-row input-group-sm" />');(g=e('<label class="col-xs-12 col-sm-4" />')).text("Relation:"),l.append(g),(r=this._buildDdropdown("urlLinkRel","Not set",null,c,null,"data-rel")).addClass("col-xs-12 col-sm-8"),r.find('.btn[data-toggle="dropdown"]').addClass("btn-sm"),l.append(r),n.append(l),a.append(n)}return a}},_generateTable:{value:function(e,t){e=parseInt(e)+1,(t=parseInt(e))||(t=1);for(var a='<table class="table">',n=1;n<=e;n++){1==n?a+="<thead>":n==e-n-1&&(a+="<tbody>"),a+="<tr>";for(var o=1;o<=t;o++)a+=1==n?"<th>Header "+o+"</th>":"<td>&nbsp;</td>";a+="</tr>",1==n?a+="</thead>":n==e&&(a+="</tbody>")}return a+="</table>"}},_updateState:{value:function(e,t){if("editor"==this._config.mode){var a=this._getTextStat(this._$content.get(0)),n=this._getPath(e,this._$content,!1);if(t)this._$toolbar.find("button[data-action]").removeClass("active");else switch(n.tags[0]){case"b":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="bold"]').addClass("active");break;case"u":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="underline"]').addClass("active");break;case"sub":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="subscript"]').addClass("active");break;case"sup":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="superscript"]').addClass("active");break;case"i":this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="text"][data-value="italic"]').addClass("active");break;case"a":this._$toolbar.find('[data-action="insert"]').removeClass("active"),this._$toolbar.find('[data-action="insert"][data-value="link"]').addClass("active");break;case"p":this._$toolbar.find('[data-action="align"]').removeClass("active"),"center"==e.css("text-align")?this._$toolbar.find('[data-action="align"][data-value="center"]').addClass("active"):"right"==e.css("text-align")?this._$toolbar.find('[data-action="align"][data-value="right"]').addClass("active"):"justify"==e.css("text-align")?this._$toolbar.find('[data-action="align"][data-value="justify"]').addClass("active"):this._$toolbar.find('[data-action="align"][data-value="left"]').addClass("active");break;default:this._$toolbar.find('[data-action="text"]').removeClass("active"),this._$toolbar.find('[data-action="align"]').removeClass("active"),this._$toolbar.find('[data-action="insert"]').removeClass("active")}this._$statusbar.path.text(n.path),this._$statusbar.stat.text("Length: "+a.length+", chars: "+a.chars+", words: "+a.words)}else{var o=this._getTextPosition(this._$content.get(0));this._$statusbar.path.empty(),parseInt(o.selected)>0?this._$statusbar.stat.text("Line: "+o.line+", column: "+o.end+", selected: "+o.selected):this._$statusbar.stat.text("Line: "+o.line+", column: "+o.end)}return this._$element}}},{Default:{get:function(){return l}},_jQueryInterface:{value:function(t){var a=this;return t=t||{},a.each(function(){var l=e(a),r=e.extend({},n.Default,l.data(),"object"==typeof t&&t);new o(a,r)})}}}),o}();return e.fn.wysiwyg=u._jQueryInterface,e.fn.wysiwyg.Constructor=u,e.fn.wysiwyg.noConflict=function(){return e.fn.wysiwyg=o,u._jQueryInterface},u}(jQuery)}(jQuery);
//# sourceMappingURL=wysiwyg.js.map